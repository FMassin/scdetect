<?xml version="1.0" encoding="UTF-8"?>
<seiscomp>
  <module name="scdetect" category="Processing" inherit-global-bindings="true">
    <description>Template matching based earthquake detection</description>
    <configuration>
      <parameter name="templatesJSON" type="path" default="@ROOTDIR@/etc/scdetect/templates.json">
        <description>
          Defines the default path for the template configuration file.
        </description>
      </parameter>
      <group name="template">
        <parameter name="phase" type="string" default="Pg">
          <description>
            Defines the default template phase. 
          </description>
        </parameter>
        <parameter name="waveformStart" type="double" default="-2" unit="s">
          <description>
            Defines the default template waveform start time in seconds w.r.t.
            the template pick.
          </description>
        </parameter>
        <parameter name="waveformEnd" type="double" default="2" unit="s">
          <description>
            Defines the default template waveform end time in seconds w.r.t.
            the template pick.
          </description>
        </parameter>
      </group>
      <group name="processing">
        <parameter name="initTime" type="int" default="60" unit="s">
          <description>
            The default initTime defines a time span in seconds a detector is
            blind after initialization. This time is needed to initialize the
            template processors and depends on it.
          </description>
        </parameter>
        <parameter name="gapInterpolation" type="boolean" default="false">
          <description>
            Interpolate gaps linearly? This is valid for gaps shorter
            than maxGapLength.
          </description>
        </parameter>
        <parameter name="minGapLength" type="double" default="0.1" unit="s">
          <description>
            The default min gap length in seconds to handle. Gaps smaller than
            the value specified won't be handled.
          </description>
        </parameter>
        <parameter name="maxGapLength" type="double" default="4.5" unit="s">
          <description>
            The default maximum gap length in seconds to handle. Gaps larger
            than the value specified will cause the detector to be reset.
          </description>
        </parameter>
      </group>
      <group name="detector">
        <parameter name="timeCorrection" type="double" default="0" unit="s">
          <description>
            Default time correction applied for an origin issued.
          </description>
        </parameter>
        <parameter name="triggerOn" type="double" default="0.85">
          <description>
            Default threshold which defines when a detector is triggered.
          </description>
        </parameter>
        <parameter name="triggerOff" type="double" default="0.65">
          <description>
            Default threshold which defines when the detector is enabled in
            order to produce new origins, again. Note that this threshold
            overrides the *triggerDuration* configuration parameter i.e. as
            soon as the *triggerOff* threshold is met a detector result is
            issued.
          </description>
        </parameter>
        <parameter name="triggerDuration" type="double" default="2" unit="s">
          <description>
            Maximum default duration in seconds after reaching the *triggerOn*
            threshold to search for the maximum correlation between configured
            streams.
          </description>
        </parameter>
        <parameter name="createArrivals" type="boolean" default="false">
          <description>
            Defines the default value for computing and associating
            *detected arrivals* with created origins i.e. detections.
          </description>
        </parameter>
        <parameter name="createTemplateArrivals" type="boolean" default="false">
          <description>
            Defines the default value for computing and associating
            *theoretical template arrivals* with created origins i.e.
            detections.
          </description>
        </parameter>
        <parameter name="arrivalOffsetThreshold" type="double" default="2.0e-6" unit="s">
          <description>
            Maximum default inter arrival offset threshold to tolerate when
            associating an arrival to an event. The threshold is only validated
            in a multi-stream detector setup. Configuring a negative value
            disables the arrival offset validation.
          </description>
        </parameter>
        <parameter name="minimumArrivals" type="int" default="-1">
          <description>
            Defines the default minimum number of arrivals which must be part
            of an event to be declared as a detection. Configuring a negative
            value disables the validation i.e. arrivals for all streams
            configured must be available.
          </description>
        </parameter>
        <parameter name="mergingStrategy" type="string" default="minTriggerOn">
          <description>
            Defines the default cross-correlation result merging strategy while
            linking. Possible values are:

            - "greaterEqualTriggerOnThreshold": the cross-correlation
            coefficient must be greater or equal to the configured
            "triggerOnThreshold" in order to be taken into account for linking.
            - "greaterEqualMergingThreshold": the cross-correlation coefficient
            must be greater or equal to the configured stream configuration
            specific `"mergingThreshold"` in order to be taken into account for
            linking.
            - "all": tries to merge all cross-correlation results. Trying to
            merge all cross-correlation results is computationally quite
            expensive.

            Note that the configured merging strategy may have a significant
            performance impact in a multi-stream detector setup.
          </description>
        </parameter>
      </group>
    </configuration>

    <command-line>
      <group name="Generic">
        <optionReference>generic#help</optionReference>
        <optionReference>generic#version</optionReference>
        <optionReference>generic#config-file</optionReference>
        <optionReference>generic#plugins</optionReference>
        <optionReference>generic#daemon</optionReference>
        <optionReference>generic#auto-shutdown</optionReference>
        <optionReference>generic#shutdown-master-module</optionReference>
        <optionReference>generic#shutdown-master-username</optionReference>
      </group>

      <group name="Verbosity">
        <optionReference>verbosity#verbosity</optionReference>
        <optionReference>verbosity#v</optionReference>
        <optionReference>verbosity#quiet</optionReference>
        <optionReference>verbosity#component</optionReference>
        <optionReference>verbosity#syslog</optionReference>
        <optionReference>verbosity#lockfile</optionReference>
        <optionReference>verbosity#console</optionReference>
        <optionReference>verbosity#debug</optionReference>
        <optionReference>verbosity#log-file</optionReference>
      </group>

      <group name="Messaging">
        <optionReference>messaging#user</optionReference>
        <optionReference>messaging#host</optionReference>
        <optionReference>messaging#timeout</optionReference>
        <optionReference>messaging#primary-group</optionReference>
        <optionReference>messaging#subscribe-group</optionReference>
        <optionReference>messaging#content-type</optionReference>
        <optionReference>messaging#start-stop-msg</optionReference>
        <option flag="" long-flag="offline">
          <description>
            Do not connect to the messaging system.
          </description>
        </option>
        <option flag="" long-flag="no-publish">
          <description>
            Runs the module as usual but does not send any messages. This can
            be useful to test the module within a running system.
          </description>
        </option>
        <option flag="" long-flag="ep">
          <description>
            Same as --no-publish, but outputs all event parameters scml
            formatted; specifying the output path as '-' (a single dash) will
            force the output to be redirected to stdout.
          </description>
        </option>
      </group>

      <group name="Database">
        <optionReference>database#db-driver-list</optionReference>
        <optionReference>database#database</optionReference>
        <optionReference>database#config-module</optionReference>
        <optionReference>database#inventory-db</optionReference>
        <option flag="" long-flag="db-disable" argument="" publicID="database#db-disable">
          <description>Do not use the database at all</description>
        </option>
        <option flag="" long-flag="event-db" argument="">
          <description>
            Load events from the given database or file, format:
            [service://]location
          </description>
        </option>
      </group>

      <group name="Records">
        <optionReference>records#record-driver-list</optionReference>
        <optionReference>records#record-url</optionReference>
        <optionReference>records#record-file</optionReference>
        <optionReference>records#record-type</optionReference>
        <option flag="" long-flag="record-starttime" argument="">
          <description>
            Defines a start time (YYYY-MM-DDTHH:MM:SS formatted) for requesting
            records from the configured archive recordstream. Implicitly
            enables reprocessing/playback mode.
          </description>
        </option>
        <option flag="" long-flag="record-endtime" argument="">
          <description>
            Defines an end time (YYYY-MM-DDTHH:MM:SS formatted) for requesting
            records from the configured archive recordstream. Implicitly
            enables reprocessing/playback mode.
          </description>
        </option>
      </group>

      <group name="Mode">
        <option flag="" long-flag="playback" default="false">
          <description>
            Use playback mode that does not restrict the maximum allowed
            data latency.
          </description>
        </option>
        <option flag="" long-flag="load-templates">
          <description>Load templates and exit.</description>
        </option>
      </group>

      <group name="Input">
        <option flag="" long-flag="template-json">
          <description>
            Path to a template configuration file (JSON formatted).
          </description>
        </option>
      </group>

    </command-line>
  </module>
</seiscomp>
